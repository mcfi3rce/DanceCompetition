#+tblname: dances
| Couple | 	A | 	B | 	C | 	D | 	E | 	F | 	G | 	H |
|--------+-----+-----+-----+-----+-----+-----+-----+-----|
|    111 |   7 |   7 |   7 |   7 |   7 |     |     |     |
|    112 |   4 |   6 |   3 |   6 |   4 |     |     |     |
|    113 |   1 |   5 |   2 |   3 |   5 |     |     |     |
|    114 |   3 |   3 |   4 |   5 |   1 |     |     |     |
|    115 |   2 |   1 |   1 |   2 |   2 |     |     |     |
|    116 |   5 |   4 |   6 |   1 |   3 |     |     |     |
|    117 |   6 |   2 |   5 |   4 |   6 |     |     |     |

#+BEGIN_SRC emacs-lisp :var dances=dances :results value
  (defun extract-place (n dances)
    (mapcar (lambda (row)
              (loop for score in (remove-if 'stringp row)
                    count (= n score)))
            dances))

  (append `(,(mapcar 'first dances) hline)
          (loop for place from 1 to 8
                collect (extract-place place dances)))
#+END_SRC

#+RESULTS:
| 111 | 112 | 113 | 114 | 115 | 116 | 117 |
|-----+-----+-----+-----+-----+-----+-----|
|   0 |   0 |   1 |   1 |   2 |   1 |   0 |
|   0 |   0 |   1 |   0 |   3 |   0 |   1 |
|   0 |   1 |   1 |   2 |   0 |   1 |   0 |
|   0 |   2 |   0 |   1 |   0 |   1 |   1 |
|   0 |   0 |   2 |   1 |   0 |   1 |   1 |
|   0 |   2 |   0 |   0 |   0 |   1 |   2 |
|   5 |   0 |   0 |   0 |   0 |   0 |   0 |
|   0 |   0 |   0 |   0 |   0 |   0 |   0 |

|     | No. |   A | 	B | 	C | 	D | 	E | 	F | 	G | 	H | 1 |   1 | 1-2 | 1-3 | 1-4 | 1-5 | 1-6 | 1-7 | 1-8 |
|-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+---+-----+-----+-----+-----+-----+-----+-----+-----|
|     | 111 |   7 |   7 |   7 |   7 |   7 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 112 |   4 |   6 |   3 |   6 |   4 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 113 |   1 |   5 |   2 |   3 |   5 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 114 |   3 |   3 |   4 |   5 |   1 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 115 |   2 |   1 |   1 |   2 |   2 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 116 |   5 |   4 |   6 |   1 |   3 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 117 |   6 |   2 |   5 |   4 |   6 |     |     |     | 1 |     |     |     |     |     |     |     |     |


|-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+---+-----+-----+-----+-----+-----+-----+-----+-----|
|     | No. |   A | 	B | 	C | 	D | 	E | 	F | 	G | 	H | 1 |   1 | 1-2 | 1-3 | 1-4 | 1-5 | 1-6 | 1-7 | 1-8 |
|-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+---+-----+-----+-----+-----+-----+-----+-----+-----|
|     | 111 |   7 |   7 |   7 |   7 |   7 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 112 |   4 |   6 |   3 |   6 |   4 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 113 |   1 |   5 |   2 |   3 |   5 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 114 |   3 |   3 |   4 |   5 |   1 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 115 |   2 |   1 |   1 |   2 |   2 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 116 |   5 |   4 |   6 |   1 |   3 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|     | 117 |   6 |   2 |   5 |   4 |   6 |     |     |     | 1 |     |     |     |     |     |     |     |     |
|-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+---+-----+-----+-----+-----+-----+-----+-----+-----|
|     |     |     |     |     |     |     |     |     |     | 1 |     |     |     |     |     |     |     |     |
#+BEGIN_SRC elisp :results value table :var dance=cha-cha
  (cons
  '(No. 1 1-2 1-3 1-4 1-5 1-6 1-7 1-8) 
   (mapcar 'list (mapcar 'car dance)))
#+END_SRC

#+tblname: places-cha-cha
#+RESULTS:
| No. | 1 | 1-2 | 1-3 | 1-4 | 1-5 | 1-6 | 1-7 | 1-8 |
| 111 |   |     |     |     |     |     |     |     |
| 112 |   |     |     |     |     |     |     |     |
| 113 |   |     |     |     |     |     |     |     |
| 114 |   |     |     |     |     |     |     |     |
| 115 |   |     |     |     |     |     |     |     |
| 116 |   |     |     |     |     |     |     |     |
| 117 |   |     |     |     |     |     |     |     |


| No.     | 1 | 1-2 | 1-3 | 1-4 | 1-5 | 1-6 | 1-7 | 1-8 |
|---------+---+-----+-----+-----+-----+-----+-----+-----|
| dancers |   |     |     |     |     |     |     |     |
| dancers |   |     |     |     |     |     |     |     |

| group | round 1 | round 2 | round 3 | round 4 |
|-------+---------+---------+---------+---------|
| A     |       1 |       2 |       3 |       3 |
| B     |     4.7 |      11 |         |         |
| C     |         |         |         |         |
| D     |       5 |         |         |         |
| E     |         |     7.2 |         |         |
| F     |     3.2 |     4.3 |         |         |
| G     |         |     4.4 |         |         |
| H     |         |       8 |         |         |
| I     |     2.2 |         |         |         |
|-------+---------+---------+---------+---------|
| total | missing |       1 |       1 |         |
 #+TBLFM: @>$3='(length(org-lookup-all "1" '(@2$2..@2$>) nil)) @>$4 = (+ @>3 1) 
